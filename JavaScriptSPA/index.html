<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>BCMS</title>
    <link rel="SHORTCUT ICON" href="https://www.binus.edu/wp-content/uploads/2020/04/sitelogo-bina-nusantara.svg" type="image/x-icon">
    
    <!-- msal.min.js can be used in the place of msal.js; included msal.js to make debug easy -->
    <script type="text/javascript" src="https://alcdn.msauth.net/lib/1.4.0/js/msal.js" integrity="sha384-DqrejB/00ccJc4ufFWc+TA3ImOruMihWCj6Wu9hEzRUNdqt4180qlzT0mFa6/Zp2" crossorigin="anonymous"></script>
    
    <script type="text/javascript" src="./request.js"></script>
    <!-- msal.js with a fallback to backup CDN -->
    <script type="text/javascript">
      if(typeof Msal === 'undefined')document.write(unescape("%3Cscript src='https://alcdn.msftauth.net/lib/1.4.0/js/msal.js' type='text/javascript' %3E%3C/script%3E"));
    </script>

    <!-- adding Bootstrap 4 for UI components  -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
  </head>
  <body>
    <div id="loadingScreen">
      <div class="loader"></div>
    </div>
    <nav class="navbar navbar-expand-lg navbar-dark">
      <a class="navbar-brand" href="/">
        <img src="https://www.binus.edu/wp-content/uploads/2020/04/sitelogo-bina-nusantara.svg"/>
      </a>
      <div id="title">
        BINUS Business Card Automatic Transfer
      </div>
      <div class="btn-group ml-auto dropleft">
        <button type="button" id="signIn" class="btn btn-secondary" onclick="signIn()">Sign In</button>
        <button type="button" id="signOut" class="btn btn-success d-none" onclick="signOut()">Sign Out</button>
    </div>
    </nav>
    <br>
    <br>
    <div class="row" style="margin:auto" >
    <div id="card-div" class="w-75 d-none">
    <div class="card text-center">
      <div class="card-body">
        <h5 class="card-title" id="welcomeMessage">Please sign-in to see your profile and read your mails</h5>
        <div id="profile-div">
          <div><strong>Status : </strong><p id="status" style="display:inline-block; font-weight:bold">Loading</p>
          </div>
        </div>
        <br>
        <!-- <button class="btn btn-primary" id="seeProfile" onclick="seeProfile()">See Profile</button> -->
          BINUS Business Card is a place to share business cards within organizations.
          <br><br>
          BINUS Business Card Automatic Transfer is a tool to run automatic transfer <a href="https://outlook.office.com/people/">Outlook Contacts</a> to BINUS Business Card.
          You can check BINUS Business Card in this link <a href="http://portal.binus.edu/resources/Lists/BusinessCard/AllItems.aspx">KM Portal</a> & <a href="https://binusianorg.sharepoint.com/sites/NewPortal/resources/Lists/Business%20Card/All%20Items.aspx">SharePoint Online</a>.
          <br><br>
        <button class="btn btn-primary d-none" id="enable" onclick="enableAccount()">Enable</button>
        <button class="btn btn-primary d-none" id="disable" onclick="disableAccount()">Disable</button>
      </div>
    </div>
    </div>
    <br>
    <br>
      <div class="col-md-4">
        <div class="list-group" id="list-tab" role="tablist">
        </div>
      </div>
      <div class="col-md-5">
        <div class="tab-content" id="nav-tabContent">
        </div>
      </div>
    </div>
    <br>
    <br>

    <!-- importing bootstrap.js and supporting js libraries -->
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>  
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    
    <!-- importing app scripts (load order is important) -->
    <script type="text/javascript" src="./authConfig.js"></script>
    <script type="text/javascript" src="./graphConfig.js"></script>
    <script type="text/javascript" src="./ui.js"></script>

    <!-- replace next line with authRedirect.js if you would like to use the redirect flow -->
    <script type="text/javascript" src="./authRedirect.js"></script>  
    <!-- <script type="text/javascript" src="./authPopup.js"></script> -->
    <script type="text/javascript" src="./graph.js"></script>
    <script type="text/javascript">
      try{
        seeProfile();
      }catch(e){
        console.log("Error");
      }
    </script>
  </body>
  <style>
    body{
      background-color: #f1f1f1;
    }
    .card-body{
      width: 100%;
    }
    #card-div{
      margin-left: 12.5%;
      border: none !important;
      box-shadow: 1px 2px 2px 0px rgba(0, 0, 0, 0.2);
    }
    nav{
      display: flex;
      justify-content: center;
      background-color: white;
      box-shadow: 1px 2px 2px 0px rgba(0, 0, 0, 0.2);
    }
    #title{
      color: #00a9e2;
      font-weight: bold;
      font-size: 24px;
    }
    #loadingScreen{
        position: fixed;
        width: 100%;
        height: 100vh;
        background-color: rgba(63, 63, 63, 0.562);
        z-index: 1000;
        
    }
    .loader {
          position: absolute;
          top: calc(50% - 60px);
          left: calc(50% - 60px);
          border: 16px solid #f3f3f3; /* Light grey */
          border-top: 16px solid #00a9e2; /* Blue */
          border-bottom: 16px solid #00a9e2; /* Blue */
          border-radius: 50%;
          width: 120px;
          height: 120px;
          animation: spin 1s linear infinite;
      }
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
    @media screen and (max-width: 700px){
      #card-div{
        margin-left: 1% !important;
        width: 98% !important;
      }
    }
  </style>
</html>